Comments pre install
====================

1.  Deploy on a local virtual machine:
    Load Ubutnu 12.04 serveubuntu-12.04-server ISO into you virtual machine
    http://releases.ubuntu.com/12.04/ubuntu-12.04-server-amd64.iso
    (tested with developer-preview on: VMware Fusion 4.0)
    
    Deploy on an IaaS platform
    Lauch the Image provided by your IaaS perovider
    tested on: Rackspace

2.  Ping google.com to check your internet connectivity and DNS.

3.  Install the ssh deamons
      sudo apt-get install openssh-client openssh-server
        n.b. Installing starts them automatically

4.  sudo apt-get install git-core
    git config --global user.name "<your name>"
    git config --global user.email "<your email>"
    visit https://help.github.com/articles/set-up-git for more info

    cd .ssh
    ssh-keygen -t rsa -C "<your email>"
    (Generate authentication keys)


Installation
============

1.  Clone the rce repository (switch branches if necessary)
      cd /opt
      sudo git clone https://github.com/IDSCETHZurich/rce.git rce

2.  Install the linux-container requirements
      sudo apt-get install lxc debootstrap

3.  Setup the container filesystem

    1.  Run setupContainer.bash to generate a 12.04 container for LXC
          cd /opt/rce/setup
          sudo bash container.bash --path=/opt/rce/container
            n.b. You may set the ubuntu mirror to the one near you
    
    2.  Enter container
            cd /opt/rce/framework
            sudo ./rcemake
    
        Inside the container do the following steps:
        (all commands require super user privileges)
    
        3.  Install ROS (refer to http://www.ros.org/wiki/fuerte/Installation/Ubuntu)
              sh -c 'echo "deb http://packages.ros.org/ros/ubuntu precise main" > /etc/apt/sources.list.d/ros-latest.list'
              wget http://packages.ros.org/ros.key -O - | apt-key add -
              apt-get update
        
            Minimal installation:
              apt-get install ros-fuerte-ros-comm ros-fuerte-common-msgs
            For test nodes:
              apt-get install ros-fuerte-ros-comm ros-fuerte-common-msgs ros-fuerte-vision-opencv
        
        4.  Add users
              adduser ros
              adduser --disabled-password --disabled-login --home /opt/rce/data rce
    
        5.  Add files and directories
              mkdir /opt/rce/src
              touch /etc/init/rceComm.conf
              touch /etc/init/rceLauncher.conf
    
        6.  Either change root password or disable root login
            For changing the password:
              passwd
            For disabling the root login:
                Edit file /etc/passwd and replace root:x:... with root:!:...
                (Can also be done from the host machine;
                To activate the login again replace root:!:... with root:x:...)
    
        7.  Leave the container (make sure you are in the container when running in a cloud)
              exit

    8.  Copy setup, make, and upstart script to container
          sudo cp /opt/rce/setup/setup.sh /opt/rce/container/rootfs/opt/rce/
          sudo cp /opt/rce/setup/rce.conf /opt/rce/container/rootfs/etc/init/

4.  Install ROS in the container host
      sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu precise main" > /etc/apt/sources.list.d/ros-latest.list'
      wget http://packages.ros.org/ros.key -O - | sudo apt-key add -
      sudo apt-get update
      sudo apt-get install ros-fuerte-ros-comm ros-fuerte-common-msgs

5.  Install the websockets related libraries
      sudo apt-get install python-twisted-core python-openssl
      sudo easy_install AutoBahn

6.  Apply patch to Autobahn library
      sudo patch [???] /opt/rce/setup/websocket.patch

7.  Install libraries needed for Custom Converters
      sudo apt-get install python-imaging

8.  Create necessary folders holding temporary data of containers
      sudo mkdir /opt/rce/container/data
      sudo mkdir /opt/rce/container/config


Post Installation
=================

1.  Copy settings file and adjust appropriately
      sudo cp /opt/rce/framework.settings.py.default /opt/rce/framework.settings.py

2.  Copy upstart scripts and adjust appropriately
      sudo cp /opt/rce/setup/rce-master.conf /etc/init/
      sudo cp /opt/rce/setup/rce-machine.conf /etc/init/
